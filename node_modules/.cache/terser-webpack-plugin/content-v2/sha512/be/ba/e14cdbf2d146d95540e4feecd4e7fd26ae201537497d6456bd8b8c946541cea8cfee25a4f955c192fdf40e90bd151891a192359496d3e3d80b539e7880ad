{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";n.r(t);const i=\"3.3.8\";var o=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}var a,s=r(function(e,t){(function(){var n={function:!0,object:!0}[typeof window]&&window||this,i=t,r=e&&!e.nodeType&&e,a=i&&r&&\"object\"==typeof o&&o;!a||a.global!==a&&a.window!==a&&a.self!==a||(n=a);var s=Math.pow(2,53)-1,c=/\\bOpera/,d=Object.prototype,l=d.hasOwnProperty,h=d.toString;function u(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function p(e){return e=b(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:u(e)}function f(e,t){for(var n in e)l.call(e,n)&&t(e[n],n,e)}function m(e){return null==e?u(e):h.call(e).slice(8,-1)}function g(e){return String(e).replace(/([ -])(?!$)/g,\"$1?\")}function v(e,t){var n=null;return function(e,t){var n=-1,i=e?e.length:0;if(\"number\"==typeof i&&i>-1&&i<=s)for(;++n<i;)t(e[n],n);else f(e,t)}(e,function(i,o){n=t(n,i,o,e)}),n}function b(e){return String(e).replace(/^ +| +$/g,\"\")}var x=function e(t){var i=n,o=t&&\"object\"==typeof t&&\"String\"!=m(t);o&&(i=t,t=null);var r=i.navigator||{},a=r.userAgent||\"\";t||(t=a);var s,d,l,u,x,y=o?!!r.likeChrome:/\\bChrome\\b/.test(t)&&!/internal|\\n/i.test(h.toString()),S=o?\"Object\":\"ScriptBridgingProxyObject\",w=o?\"Object\":\"Environment\",C=o&&i.java?\"JavaPackage\":m(i.java),O=o?\"Object\":\"RuntimeObject\",M=/\\bJava/.test(C)&&i.java,I=M&&m(i.environment)==w,T=M?\"a\":\"α\",E=M?\"b\":\"β\",k=i.document||{},R=i.operamini||i.opera,L=c.test(L=o&&R?R[\"[[Class]]\"]:m(R))?L:R=null,A=t,P=[],j=null,D=t==a,N=D&&R&&\"function\"==typeof R.version&&R.version(),_=v([{label:\"EdgeHTML\",pattern:\"Edge\"},\"Trident\",{label:\"WebKit\",pattern:\"AppleWebKit\"},\"iCab\",\"Presto\",\"NetFront\",\"Tasman\",\"KHTML\",\"Gecko\"],function(e,n){return e||RegExp(\"\\\\b\"+(n.pattern||g(n))+\"\\\\b\",\"i\").exec(t)&&(n.label||n)}),$=v([\"Adobe AIR\",\"Arora\",\"Avant Browser\",\"Breach\",\"Camino\",\"Electron\",\"Epiphany\",\"Fennec\",\"Flock\",\"Galeon\",\"GreenBrowser\",\"iCab\",\"Iceweasel\",\"K-Meleon\",\"Konqueror\",\"Lunascape\",\"Maxthon\",{label:\"Microsoft Edge\",pattern:\"Edge\"},\"Midori\",\"Nook Browser\",\"PaleMoon\",\"PhantomJS\",\"Raven\",\"Rekonq\",\"RockMelt\",{label:\"Samsung Internet\",pattern:\"SamsungBrowser\"},\"SeaMonkey\",{label:\"Silk\",pattern:\"(?:Cloud9|Silk-Accelerated)\"},\"Sleipnir\",\"SlimBrowser\",{label:\"SRWare Iron\",pattern:\"Iron\"},\"Sunrise\",\"Swiftfox\",\"Waterfox\",\"WebPositive\",\"Opera Mini\",{label:\"Opera Mini\",pattern:\"OPiOS\"},\"Opera\",{label:\"Opera\",pattern:\"OPR\"},\"Chrome\",{label:\"Chrome Mobile\",pattern:\"(?:CriOS|CrMo)\"},{label:\"Firefox\",pattern:\"(?:Firefox|Minefield)\"},{label:\"Firefox for iOS\",pattern:\"FxiOS\"},{label:\"IE\",pattern:\"IEMobile\"},{label:\"IE\",pattern:\"MSIE\"},\"Safari\"],function(e,n){return e||RegExp(\"\\\\b\"+(n.pattern||g(n))+\"\\\\b\",\"i\").exec(t)&&(n.label||n)}),F=B([{label:\"BlackBerry\",pattern:\"BB10\"},\"BlackBerry\",{label:\"Galaxy S\",pattern:\"GT-I9000\"},{label:\"Galaxy S2\",pattern:\"GT-I9100\"},{label:\"Galaxy S3\",pattern:\"GT-I9300\"},{label:\"Galaxy S4\",pattern:\"GT-I9500\"},{label:\"Galaxy S5\",pattern:\"SM-G900\"},{label:\"Galaxy S6\",pattern:\"SM-G920\"},{label:\"Galaxy S6 Edge\",pattern:\"SM-G925\"},{label:\"Galaxy S7\",pattern:\"SM-G930\"},{label:\"Galaxy S7 Edge\",pattern:\"SM-G935\"},\"Google TV\",\"Lumia\",\"iPad\",\"iPod\",\"iPhone\",\"Kindle\",{label:\"Kindle Fire\",pattern:\"(?:Cloud9|Silk-Accelerated)\"},\"Nexus\",\"Nook\",\"PlayBook\",\"PlayStation Vita\",\"PlayStation\",\"TouchPad\",\"Transformer\",{label:\"Wii U\",pattern:\"WiiU\"},\"Wii\",\"Xbox One\",{label:\"Xbox 360\",pattern:\"Xbox\"},\"Xoom\"]),V=v({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,\"Kindle Fire\":1},Asus:{Transformer:1},\"Barnes & Noble\":{Nook:1},BlackBerry:{PlayBook:1},Google:{\"Google TV\":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,\"Xbox One\":1},Motorola:{Xoom:1},Nintendo:{\"Wii U\":1,Wii:1},Nokia:{Lumia:1},Samsung:{\"Galaxy S\":1,\"Galaxy S2\":1,\"Galaxy S3\":1,\"Galaxy S4\":1},Sony:{PlayStation:1,\"PlayStation Vita\":1}},function(e,n,i){return e||(n[F]||n[/^[a-z]+(?: +[a-z]+\\b)*/i.exec(F)]||RegExp(\"\\\\b\"+g(i)+\"(?:\\\\b|\\\\w*\\\\d)\",\"i\").exec(t))&&i}),W=v([\"Windows Phone\",\"Android\",\"CentOS\",{label:\"Chrome OS\",pattern:\"CrOS\"},\"Debian\",\"Fedora\",\"FreeBSD\",\"Gentoo\",\"Haiku\",\"Kubuntu\",\"Linux Mint\",\"OpenBSD\",\"Red Hat\",\"SuSE\",\"Ubuntu\",\"Xubuntu\",\"Cygwin\",\"Symbian OS\",\"hpwOS\",\"webOS \",\"webOS\",\"Tablet OS\",\"Tizen\",\"Linux\",\"Mac OS X\",\"Macintosh\",\"Mac\",\"Windows 98;\",\"Windows \"],function(e,n){var i=n.pattern||g(n);return!e&&(e=RegExp(\"\\\\b\"+i+\"(?:/[\\\\d.]+|[ \\\\w.]*)\",\"i\").exec(t))&&(e=function(e,t,n){var i={\"10.0\":\"10\",6.4:\"10 Technical Preview\",6.3:\"8.1\",6.2:\"8\",6.1:\"Server 2008 R2 / 7\",\"6.0\":\"Server 2008 / Vista\",5.2:\"Server 2003 / XP 64-bit\",5.1:\"XP\",5.01:\"2000 SP1\",\"5.0\":\"2000\",\"4.0\":\"NT\",\"4.90\":\"ME\"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(i=i[/[\\d.]+$/.exec(e)])&&(e=\"Windows \"+i),e=String(e),t&&n&&(e=e.replace(RegExp(t,\"i\"),n)),p(e.replace(/ ce$/i,\" CE\").replace(/\\bhpw/i,\"web\").replace(/\\bMacintosh\\b/,\"Mac OS\").replace(/_PowerPC\\b/i,\" OS\").replace(/\\b(OS X) [^ \\d]+/i,\"$1\").replace(/\\bMac (OS X)\\b/,\"$1\").replace(/\\/(\\d)/,\" $1\").replace(/_/g,\".\").replace(/(?: BePC|[ .]*fc[ \\d.]+)$/i,\"\").replace(/\\bx86\\.64\\b/gi,\"x86_64\").replace(/\\b(Windows Phone) OS\\b/,\"$1\").replace(/\\b(Chrome OS \\w+) [\\d.]+\\b/,\"$1\").split(\" on \")[0])}(e,i,n.label||n)),e});function B(e){return v(e,function(e,n){var i=n.pattern||g(n);return!e&&(e=RegExp(\"\\\\b\"+i+\" *\\\\d+[.\\\\w_]*\",\"i\").exec(t)||RegExp(\"\\\\b\"+i+\" *\\\\w+-[\\\\w]*\",\"i\").exec(t)||RegExp(\"\\\\b\"+i+\"(?:; *(?:[a-z]+[_-])?[a-z]+\\\\d+|[^ ();-]*)\",\"i\").exec(t))&&((e=String(n.label&&!RegExp(i,\"i\").test(n.label)?n.label:e).split(\"/\"))[1]&&!/[\\d.]+/.test(e[0])&&(e[0]+=\" \"+e[1]),n=n.label||n,e=p(e[0].replace(RegExp(i,\"i\"),n).replace(RegExp(\"; *(?:\"+n+\"[_-])?\",\"i\"),\" \").replace(RegExp(\"(\"+n+\")[-_.]?(\\\\w)\",\"i\"),\"$1 $2\"))),e})}if(_&&(_=[_]),V&&!F&&(F=B([V])),(s=/\\bGoogle TV\\b/.exec(F))&&(F=s[0]),/\\bSimulator\\b/i.test(t)&&(F=(F?F+\" \":\"\")+\"Simulator\"),\"Opera Mini\"==$&&/\\bOPiOS\\b/.test(t)&&P.push(\"running in Turbo/Uncompressed mode\"),\"IE\"==$&&/\\blike iPhone OS\\b/.test(t)?(V=(s=e(t.replace(/like iPhone OS/,\"\"))).manufacturer,F=s.product):/^iP/.test(F)?($||($=\"Safari\"),W=\"iOS\"+((s=/ OS ([\\d_]+)/i.exec(t))?\" \"+s[1].replace(/_/g,\".\"):\"\")):\"Konqueror\"!=$||/buntu/i.test(W)?V&&\"Google\"!=V&&(/Chrome/.test($)&&!/\\bMobile Safari\\b/i.test(t)||/\\bVita\\b/.test(F))||/\\bAndroid\\b/.test(W)&&/^Chrome/.test($)&&/\\bVersion\\//i.test(t)?($=\"Android Browser\",W=/\\bAndroid\\b/.test(W)?W:\"Android\"):\"Silk\"==$?(/\\bMobi/i.test(t)||(W=\"Android\",P.unshift(\"desktop mode\")),/Accelerated *= *true/i.test(t)&&P.unshift(\"accelerated\")):\"PaleMoon\"==$&&(s=/\\bFirefox\\/([\\d.]+)\\b/.exec(t))?P.push(\"identifying as Firefox \"+s[1]):\"Firefox\"==$&&(s=/\\b(Mobile|Tablet|TV)\\b/i.exec(t))?(W||(W=\"Firefox OS\"),F||(F=s[1])):!$||(s=!/\\bMinefield\\b/i.test(t)&&/\\b(?:Firefox|Safari)\\b/.exec($))?($&&!F&&/[\\/,]|^[^(]+?\\)/.test(t.slice(t.indexOf(s+\"/\")+8))&&($=null),(s=F||V||W)&&(F||V||/\\b(?:Android|Symbian OS|Tablet OS|webOS)\\b/.test(W))&&($=/[a-z]+(?: Hat)?/i.exec(/\\bAndroid\\b/.test(W)?W:s)+\" Browser\")):\"Electron\"==$&&(s=(/\\bChrome\\/([\\d.]+)\\b/.exec(t)||0)[1])&&P.push(\"Chromium \"+s):W=\"Kubuntu\",N||(N=v([\"(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\\\d.]+$))\",\"Version\",g($),\"(?:Firefox|Minefield|NetFront)\"],function(e,n){return e||(RegExp(n+\"(?:-[\\\\d.]+/|(?: for [\\\\w-]+)?[ /-])([\\\\d.]+[^ ();/_-]*)\",\"i\").exec(t)||0)[1]||null})),(s=(\"iCab\"==_&&parseFloat(N)>3?\"WebKit\":/\\bOpera\\b/.test($)&&(/\\bOPR\\b/.test(t)?\"Blink\":\"Presto\"))||/\\b(?:Midori|Nook|Safari)\\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(_)&&\"WebKit\"||!_&&/\\bMSIE\\b/i.test(t)&&(\"Mac OS\"==W?\"Tasman\":\"Trident\")||\"WebKit\"==_&&/\\bPlayStation\\b(?! Vita\\b)/i.test($)&&\"NetFront\")&&(_=[s]),\"IE\"==$&&(s=(/; *(?:XBLWP|ZuneWP)(\\d+)/i.exec(t)||0)[1])?($+=\" Mobile\",W=\"Windows Phone \"+(/\\+$/.test(s)?s:s+\".x\"),P.unshift(\"desktop mode\")):/\\bWPDesktop\\b/i.test(t)?($=\"IE Mobile\",W=\"Windows Phone 8.x\",P.unshift(\"desktop mode\"),N||(N=(/\\brv:([\\d.]+)/.exec(t)||0)[1])):\"IE\"!=$&&\"Trident\"==_&&(s=/\\brv:([\\d.]+)/.exec(t))&&($&&P.push(\"identifying as \"+$+(N?\" \"+N:\"\")),$=\"IE\",N=s[1]),D){if(u=\"global\",x=null!=(l=i)?typeof l[u]:\"number\",/^(?:boolean|number|string|undefined)$/.test(x)||\"object\"==x&&!l[u])m(s=i.runtime)==S?($=\"Adobe AIR\",W=s.flash.system.Capabilities.os):m(s=i.phantom)==O?($=\"PhantomJS\",N=(s=s.version||null)&&s.major+\".\"+s.minor+\".\"+s.patch):\"number\"==typeof k.documentMode&&(s=/\\bTrident\\/(\\d+)/i.exec(t))?(N=[N,k.documentMode],(s=+s[1]+4)!=N[1]&&(P.push(\"IE \"+N[1]+\" mode\"),_&&(_[1]=\"\"),N[1]=s),N=\"IE\"==$?String(N[1].toFixed(1)):N[0]):\"number\"==typeof k.documentMode&&/^(?:Chrome|Firefox)\\b/.test($)&&(P.push(\"masking as \"+$+\" \"+N),$=\"IE\",N=\"11.0\",_=[\"Trident\"],W=\"Windows\");else if(M&&(A=(s=M.lang.System).getProperty(\"os.arch\"),W=W||s.getProperty(\"os.name\")+\" \"+s.getProperty(\"os.version\")),I){try{N=i.require(\"ringo/engine\").version.join(\".\"),$=\"RingoJS\"}catch(e){(s=i.system)&&s.global.system==i.system&&($=\"Narwhal\",W||(W=s[0].os||null))}$||($=\"Rhino\")}else\"object\"==typeof i.process&&!i.process.browser&&(s=i.process)&&(\"object\"==typeof s.versions&&(\"string\"==typeof s.versions.electron?(P.push(\"Node \"+s.versions.node),$=\"Electron\",N=s.versions.electron):\"string\"==typeof s.versions.nw&&(P.push(\"Chromium \"+N,\"Node \"+s.versions.node),$=\"NW.js\",N=s.versions.nw)),$||($=\"Node.js\",A=s.arch,W=s.platform,N=(N=/[\\d.]+/.exec(s.version))?N[0]:null));W=W&&p(W)}if(N&&(s=/(?:[ab]|dp|pre|[ab]\\d+pre)(?:\\d+\\+?)?$/i.exec(N)||/(?:alpha|beta)(?: ?\\d)?/i.exec(t+\";\"+(D&&r.appMinorVersion))||/\\bMinefield\\b/i.test(t)&&\"a\")&&(j=/b/i.test(s)?\"beta\":\"alpha\",N=N.replace(RegExp(s+\"\\\\+?$\"),\"\")+(\"beta\"==j?E:T)+(/\\d+\\+?/.exec(s)||\"\")),\"Fennec\"==$||\"Firefox\"==$&&/\\b(?:Android|Firefox OS)\\b/.test(W))$=\"Firefox Mobile\";else if(\"Maxthon\"==$&&N)N=N.replace(/\\.[\\d.]+/,\".x\");else if(/\\bXbox\\b/i.test(F))\"Xbox 360\"==F&&(W=null),\"Xbox 360\"==F&&/\\bIEMobile\\b/.test(t)&&P.unshift(\"mobile mode\");else if(!/^(?:Chrome|IE|Opera)$/.test($)&&(!$||F||/Browser|Mobi/.test($))||\"Windows CE\"!=W&&!/Mobi/i.test(t))if(\"IE\"==$&&D)try{null===i.external&&P.unshift(\"platform preview\")}catch(e){P.unshift(\"embedded\")}else(/\\bBlackBerry\\b/.test(F)||/\\bBB10\\b/.test(t))&&(s=(RegExp(F.replace(/ +/g,\" *\")+\"/([.\\\\d]+)\",\"i\").exec(t)||0)[1]||N)?(W=((s=[s,/BB10/.test(t)])[1]?(F=null,V=\"BlackBerry\"):\"Device Software\")+\" \"+s[0],N=null):this!=f&&\"Wii\"!=F&&(D&&R||/Opera/.test($)&&/\\b(?:MSIE|Firefox)\\b/i.test(t)||\"Firefox\"==$&&/\\bOS X (?:\\d+\\.){2,}/.test(W)||\"IE\"==$&&(W&&!/^Win/.test(W)&&N>5.5||/\\bWindows XP\\b/.test(W)&&N>8||8==N&&!/\\bTrident\\b/.test(t)))&&!c.test(s=e.call(f,t.replace(c,\"\")+\";\"))&&s.name&&(s=\"ing as \"+s.name+((s=s.version)?\" \"+s:\"\"),c.test($)?(/\\bIE\\b/.test(s)&&\"Mac OS\"==W&&(W=null),s=\"identify\"+s):(s=\"mask\"+s,$=L?p(L.replace(/([a-z])([A-Z])/g,\"$1 $2\")):\"Opera\",/\\bIE\\b/.test(s)&&(W=null),D||(N=null)),_=[\"Presto\"],P.push(s));else $+=\" Mobile\";(s=(/\\bAppleWebKit\\/([\\d.]+\\+?)/i.exec(t)||0)[1])&&(s=[parseFloat(s.replace(/\\.(\\d)$/,\".0$1\")),s],\"Safari\"==$&&\"+\"==s[1].slice(-1)?($=\"WebKit Nightly\",j=\"alpha\",N=s[1].slice(0,-1)):N!=s[1]&&N!=(s[2]=(/\\bSafari\\/([\\d.]+\\+?)/i.exec(t)||0)[1])||(N=null),s[1]=(/\\bChrome\\/([\\d.]+)/i.exec(t)||0)[1],537.36==s[0]&&537.36==s[2]&&parseFloat(s[1])>=28&&\"WebKit\"==_&&(_=[\"Blink\"]),D&&(y||s[1])?(_&&(_[1]=\"like Chrome\"),s=s[1]||((s=s[0])<530?1:s<532?2:s<532.05?3:s<533?4:s<534.03?5:s<534.07?6:s<534.1?7:s<534.13?8:s<534.16?9:s<534.24?10:s<534.3?11:s<535.01?12:s<535.02?\"13+\":s<535.07?15:s<535.11?16:s<535.19?17:s<536.05?18:s<536.1?19:s<537.01?20:s<537.11?\"21+\":s<537.13?23:s<537.18?24:s<537.24?25:s<537.36?26:\"Blink\"!=_?\"27\":\"28\")):(_&&(_[1]=\"like Safari\"),s=(s=s[0])<400?1:s<500?2:s<526?3:s<533?4:s<534?\"4+\":s<535?5:s<537?6:s<538?7:s<601?8:\"8\"),_&&(_[1]+=\" \"+(s+=\"number\"==typeof s?\".x\":/[.+]/.test(s)?\"\":\"+\")),\"Safari\"==$&&(!N||parseInt(N)>45)&&(N=s)),\"Opera\"==$&&(s=/\\bzbov|zvav$/.exec(W))?($+=\" \",P.unshift(\"desktop mode\"),\"zvav\"==s?($+=\"Mini\",N=null):$+=\"Mobile\",W=W.replace(RegExp(\" *\"+s+\"$\"),\"\")):\"Safari\"==$&&/\\bChrome\\b/.exec(_&&_[1])&&(P.unshift(\"desktop mode\"),$=\"Chrome Mobile\",N=null,/\\bOS X\\b/.test(W)?(V=\"Apple\",W=\"iOS 4.3+\"):W=null),N&&0==N.indexOf(s=/[\\d.]+$/.exec(W))&&t.indexOf(\"/\"+s+\"-\")>-1&&(W=b(W.replace(s,\"\"))),_&&!/\\b(?:Avant|Nook)\\b/.test($)&&(/Browser|Lunascape|Maxthon/.test($)||\"Safari\"!=$&&/^iOS/.test(W)&&/\\bSafari\\b/.test(_[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test($)&&_[1])&&(s=_[_.length-1])&&P.push(s),P.length&&(P=[\"(\"+P.join(\"; \")+\")\"]),V&&F&&F.indexOf(V)<0&&P.push(\"on \"+V),F&&P.push((/^on /.test(P[P.length-1])?\"\":\"on \")+F),W&&(s=/ ([\\d.+]+)$/.exec(W),d=s&&\"/\"==W.charAt(W.length-s[0].length-1),W={architecture:32,family:s&&!d?W.replace(s[0],\"\"):W,version:s?s[1]:null,toString:function(){var e=this.version;return this.family+(e&&!d?\" \"+e:\"\")+(64==this.architecture?\" 64-bit\":\"\")}}),(s=/\\b(?:AMD|IA|Win|WOW|x86_|x)64\\b/i.exec(A))&&!/\\bi686\\b/i.test(A)?(W&&(W.architecture=64,W.family=W.family.replace(RegExp(\" *\"+s),\"\")),$&&(/\\bWOW64\\b/i.test(t)||D&&/\\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\\bWin64; x64\\b/i.test(t))&&P.unshift(\"32-bit\")):W&&/^OS X/.test(W.family)&&\"Chrome\"==$&&parseFloat(N)>=39&&(W.architecture=64),t||(t=null);var G={};return G.description=t,G.layout=_&&_[0],G.manufacturer=V,G.name=$,G.prerelease=j,G.product=F,G.ua=t,G.version=$&&N,G.os=W||{architecture:null,family:null,version:null,toString:function(){return\"null\"}},G.parse=e,G.toString=function(){return this.description||\"\"},G.version&&P.unshift(N),G.name&&P.unshift($),W&&$&&(W!=String(W).split(\" \")[0]||W!=$.split(\" \")[0]&&!F)&&P.push(F?\"(\"+W+\")\":\"on \"+W),P.length&&(G.description=P.join(\" \")),G}();i&&r?f(x,function(e,t){i[t]=e}):n.platform=x}).call(o)}),c=r(function(e,t){e.exports=function(){var e=function(e){return function(e){return!!e&&\"object\"==typeof e}(e)&&!function(e){var n=Object.prototype.toString.call(e);return\"[object RegExp]\"===n||\"[object Date]\"===n||function(e){return e.$$typeof===t}(e)}(e)},t=\"function\"==typeof Symbol&&Symbol.for?Symbol.for(\"react.element\"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?r((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function i(e,t,i){return e.concat(t).map(function(e){return n(e,i)})}function o(e,t,i){var o={};return i.isMergeableObject(e)&&Object.keys(e).forEach(function(t){o[t]=n(e[t],i)}),Object.keys(t).forEach(function(a){i.isMergeableObject(t[a])&&e[a]?o[a]=function(e,t){if(!t.customMerge)return r;var n=t.customMerge(e);return\"function\"==typeof n?n:r}(a,i)(e[a],t[a],i):o[a]=n(t[a],i)}),o}function r(t,r,a){(a=a||{}).arrayMerge=a.arrayMerge||i,a.isMergeableObject=a.isMergeableObject||e;var s=Array.isArray(r);return s===Array.isArray(t)?s?a.arrayMerge(t,r,a):o(t,r,a):n(r,a)}return r.all=function(e,t){if(!Array.isArray(e))throw new Error(\"first argument should be an array\");return e.reduce(function(e,n){return r(e,n,t)},{})},r}()}),d=\"object\"==typeof Reflect?Reflect:null,l=d&&\"function\"==typeof d.apply?d.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};a=d&&\"function\"==typeof d.ownKeys?d.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var h=Number.isNaN||function(e){return e!=e};function u(){u.init.call(this)}var p=u;u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var f=10;function m(e){return void 0===e._maxListeners?u.defaultMaxListeners:e._maxListeners}function g(e,t,n,i){var o,r,a,s;if(\"function\"!=typeof n)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof n);if(void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit(\"newListener\",t,n.listener?n.listener:n),r=e._events),a=r[t]),void 0===a)a=r[t]=n,++e._eventsCount;else if(\"function\"==typeof a?a=r[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),(o=m(e))>0&&a.length>o&&!a.warned){a.warned=!0;var c=new Error(\"Possible EventEmitter memory leak detected. \"+a.length+\" \"+String(t)+\" listeners added. Use emitter.setMaxListeners() to increase limit\");c.name=\"MaxListenersExceededWarning\",c.emitter=e,c.type=t,c.count=a.length,s=c,console&&console.warn&&console.warn(s)}return e}function v(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,l(this.listener,this.target,e))}.bind(i);return o.listener=n,i.wrapFn=o,o}function b(e,t,n){var i=e._events;if(void 0===i)return[];var o=i[t];return void 0===o?[]:\"function\"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(o):y(o,o.length)}function x(e){var t=this._events;if(void 0!==t){var n=t[e];if(\"function\"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}Object.defineProperty(u,\"defaultMaxListeners\",{enumerable:!0,get:function(){return f},set:function(e){if(\"number\"!=typeof e||e<0||h(e))throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received '+e+\".\");f=e}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(e){if(\"number\"!=typeof e||e<0||h(e))throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received '+e+\".\");return this._maxListeners=e,this},u.prototype.getMaxListeners=function(){return m(this)},u.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=\"error\"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var a=new Error(\"Unhandled error.\"+(r?\" (\"+r.message+\")\":\"\"));throw a.context=r,a}var s=o[e];if(void 0===s)return!1;if(\"function\"==typeof s)l(s,this,t);else{var c=s.length,d=y(s,c);for(n=0;n<c;++n)l(d[n],this,t)}return!0},u.prototype.addListener=function(e,t){return g(this,e,t,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(e,t){return g(this,e,t,!0)},u.prototype.once=function(e,t){if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);return this.on(e,v(this,e,t)),this},u.prototype.prependOnceListener=function(e,t){if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,v(this,e,t)),this},u.prototype.removeListener=function(e,t){var n,i,o,r,a;if(\"function\"!=typeof t)throw new TypeError('The \"listener\" argument must be of type Function. Received type '+typeof t);if(void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit(\"removeListener\",e,n.listener||t));else if(\"function\"!=typeof n){for(o=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){a=n[r].listener,o=r;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit(\"removeListener\",e,a||t)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var o,r=Object.keys(n);for(i=0;i<r.length;++i)\"removeListener\"!==(o=r[i])&&this.removeAllListeners(o);return this.removeAllListeners(\"removeListener\"),this._events=Object.create(null),this._eventsCount=0,this}if(\"function\"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},u.prototype.listeners=function(e){return b(this,e,!0)},u.prototype.rawListeners=function(e){return b(this,e,!1)},u.listenerCount=function(e,t){return\"function\"==typeof e.listenerCount?e.listenerCount(t):x.call(e,t)},u.prototype.listenerCount=x,u.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]};class S{constructor(){this.token,this.serviceId,this.config,this.version,this.channel={id:void 0,name:void 0,peers:[],startTime:void 0,status:void 0,type:void 0,members:[]},this.localVideo,this.remoteMedia,this.remoteMedia2,this.localStream,this.remoteStream,this.transceivers=null,this.devices={currentVideoInput:-1,currentAudioInput:-1,videoInput:[],audioInput:[],audioOutput:[]},this.peerConnection,this.dataConnection,this.state,this.isConnectToSig=!1,this.elive,this.callEvent,this.eventManager,this.mediaManager,this.signaler,this.messaging,this.country=void 0,this.purpose=\"P2P\",this.startTime=0,this.endTime=0,this.health=void 0}}const w=(()=>{let e,t,n;function i(...t){\"SILENT\"!==e&&\"ERROR\"!==e&&\"WARN\"!==e&&console.info(...t)}return Object.freeze({init:function(i){e=(t=i).config.sdk.logLevel,n=t.config.sdk.url.log},e:function(...t){\"SILENT\"!==e&&console.error(...t)},w:function(...t){\"SILENT\"!==e&&\"ERROR\"!==e&&console.warn(...t)},l:function(...e){i(...e)},i:i,d:function(...t){\"SILENT\"!==e&&\"ERROR\"!==e&&\"WARN\"!==e&&\"INFO\"!==e&&console.debug(...t)},v:function(...t){\"SILENT\"!==e&&\"ERROR\"!==e&&\"WARN\"!==e&&\"INFO\"!==e&&\"DEBUG\"!==e&&console.trace(...t)},t:function(e,t){\"CALLER\"!==e.role&&\"CASTOR\"!==e.role&&fetch(e.config.sdk.url.channelLog,{method:\"POST\",body:JSON.stringify(t),headers:{\"Content-Type\":\"application/json\"}}).catch(e=>{console.error(e)})},evt:function(e,n){const i={topic:\"log\",messages:{log:e,logLevel:n?\"error\":\"info\",sdkVersion:t.version,svcId:t.serviceId,pId:t.token,chId:t.channel.id,errorCode:n||\"2000\"}};fetch(t.config.sdk.url.log,{method:\"PUT\",mode:\"cors\",headers:{\"Content-Type\":\"application/json; charset=utf-8\",\"Access-Control-Allow-Origin\":\"*\"},body:JSON.stringify(i)})}})})();class C extends Error{constructor(e,t){super(e.text),this.name=\"ELiveError\",this.code=e.code,this.text=e.text,t&&console.error(t)}}class O{constructor(e){this.ctx=e,this.pc=new RTCPeerConnection(e.config.rtc),this.ctx.dataConnection=this.pc,this.channel}startAnswer(e){w.i(\"start answer for dc\"),this.pc.setRemoteDescription(e).then(()=>{w.d(\"remote description(offer) for dc is set\")}).catch(e=>{throw console.error(e),new C({code:\"1300\",text:\"remote description for dc is wrong\"})}),\"offer\"===e.type&&this.pc.createAnswer().then(e=>{this.pc.setLocalDescription(e).then(()=>{w.d(\"local description(answer) for dc is set\");const t=this.ctx.signaler.createMessage({command:\"sdp\",body:JSON.stringify(e)});t.to=this.ctx.peerConnection.to,t.pctype=\"DC\",this.ctx.signaler.send(t)})}).catch(e=>{throw new C({code:\"1300\",text:\"failed to create answer for dc\"},e)})}close(){w.d(\"datachannel is close\"),this.pc.close(),this.ctx.dataConnection=null,this.channel=null}setRemoteDesciption(e){this.pc.setRemoteDescription(e).then(()=>{w.i(\"remote description(answer) is set\")}).catch(e=>{throw console.error(e),new C({code:\"1300\",text:\"remote description(answer) is wrong\"})})}startOffer(){w.d(\"startOffer is started\"),this.channel=this.pc.createDataChannel(\"chat\"),this.channel.onopen=(e=>w.d(\"datachannel is connected\")),this.channel.onmessage=(e=>this.ctx.callEvent({name:\"onMessage\",param:e.data})),this.pc.createOffer().then(e=>{this.pc.setLocalDescription(e).then(()=>{w.d(\"local description for dc is set\");const t=this.ctx.signaler.createMessage({command:\"sdp\",body:JSON.stringify(e)});t.to=this.ctx.channel.master,t.pctype=\"DC\",w.v(t),this.ctx.signaler.send(t)})})}listening(){w.d(\"listening is started\"),this.pc.ondatachannel=(e=>{this.channel=e.channel,console.log(this.channel),this.channel.onopen=(e=>w.d(\"datachannel is connected\")),this.channel.onmessage=(e=>this.ctx.callEvent({name:\"onMessage\",param:e.data}))})}sendMessage(e){w.d(`sendMessage: ${e}`),this.channel&&this.channel.send(e)}}const M=(()=>Object.freeze({validateConfig:function(e){e.config.credential&&e.config.credential.serviceId&&e.config.credential.key||(e.config.credential={serviceId:\"SERVICEID1\",key:\"1234567890\"})},validateDevices:async function(e){w.d(\"start gathering available devices\");var t=-1,n=-1;e.config.media.video&&e.config.media.video.deviceId&&(t=e.config.media.video.deviceId),e.config.media.audio&&e.config.media.audio.deviceId&&(n=e.config.media.audio.deviceId),await navigator.mediaDevices.enumerateDevices().then(i=>{for(var o=0;o<i.length;o++){const a=i[o];if(\"videoinput\"===a.kind){var r=e.devices.videoInput.push({text:a.label,id:a.deviceId});a.deviceId===t&&(e.devices.currentVideoInput=r-1)}else\"audioinput\"===a.kind?(r=e.devices.audioInput.push({text:a.label,id:a.deviceId}),a.deviceId===n&&(e.devices.currentAudioInput=r-1)):\"audiooutput\"===a.kind&&e.devices.audioOutput.push({text:a.label,id:a.deviceId})}}),-1===e.devices.currentVideoInput&&e.devices.videoInput.length>0&&(e.devices.currentVideoInput=0),-1===e.devices.currentAudioInput&&e.devices.audioInput.length>0&&(e.devices.currentAudioInput=0),w.v(e.devices),w.d(\"finish gathering available devices\")},getMusicConfiguration:function(){return{mandatory:{googHighpassFilter:!1,googEchoCancellation:!1,googEchoCancellation2:!1,googAutoGainControl:!1,googAutoGainControl2:!1,googNoiseSuppression:!1,googNoiseSuppression2:!1,googTypingNoiseDetection:!1,echoCancellation:!1},optional:[{googCpuOveruseDetection:!1}]}},makeTransactionLog:function(e){return{pid:e.token,svcid:e.config.credential.serviceId,cid:e.channel.id,type:e.channel.type,start_time:e.startTime,duration:Math.round((e.endTime-e.startTime)/1e3),network:\"wifi\",status:e.state}}}))();class I extends p{constructor(e){super(),this.ctx=e,this.onMessageHandler=null,this.ws,this.MAX_RETRIES=11}init(){w.d(\"start signaler init\"),this.ctx.isConnectToSig=!1,this.ctx.sigMsgHandler=function(e){const t={onCall(t){w.i(`start onCall with chid:${t.channel.id}`),t.pctype&&\"DC\"===t.pctype||(e.channel=t.channel),e.role=\"CALLER\",e.callEvent({name:\"onCall\",param:{channel:e.channel}}),e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.localStream.getTracks().forEach(t=>e.peerConnection.addTrack(t,e.localStream)),e.peerConnection.ontrack=d,e.messaging=new O(e),e.messaging.listening(),e.dataConnection.onicecandidate=r,e.peerConnection.oniceconnectionstatechange=s},onCallee(t){w.i(`start onCallee with chid:${t.channel.id}`),t.pctype&&\"DC\"===t.pctype||(e.channel=t.channel),e.role=\"CALLEE\",e.callEvent({name:\"onCall\",param:{channel:e.channel}}),e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.localStream.getTracks().forEach(t=>e.peerConnection.addTrack(t,e.localStream)),e.peerConnection.ontrack=d,e.peerConnection.oniceconnectionstatechange=s,e.peerConnection.to=e.channel.master,e.peerConnection.onnegotiationneeded=c,e.messaging=new O(e),e.messaging.startOffer(),e.dataConnection.onicecandidate=r,e.peerConnection.createOffer({offerToReceiveAudio:1,offerToReceiveVideo:1}).then(t=>{t.sdp=i(t.sdp,/m=video(:?.*)?/,\"H264\"),t.sdp=t.sdp.replace(\"a=fmtp:111 minptime=10;useinbandfec=1\",\"a=fmtp:111 useinbandfec=1;minptime=10;stereo=1;cbr=1;maxaveragebitrate=400000\"),e.config.media.video.bitrate&&(t.sdp=n(t.sdp,\"video\",e.config.media.video.bitrate)),e.peerConnection.setLocalDescription(t).then(()=>{w.d(\"local description setted\");const n=e.signaler.createMessage({command:\"sdp\",body:JSON.stringify(t)});n.to=e.channel.master,w.d(`local offer msg: ${JSON.stringify(n)}`),e.signaler.send(n)})})},onCast(t){t.status>3099?e.callEvent({name:\"error\",param:new C({code:t.status,text:t.desc})}):(w.i(`start onCast with chid: ${t.channel.id}`),e.channel=t.channel,e.callEvent({name:\"onCast\",param:{channel:e.channel}}),e.role=\"CASTOR\",e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.localStream.getTracks().forEach(t=>e.peerConnection.addTransceiver(t,{direction:\"sendonly\",streams:[e.localStream]})),e.peerConnection.ontrack=d,e.peerConnection.oniceconnectionstatechange=s,e.peerConnection.to=e.channel.members[0].id,e.peerConnection.onnegotiationneeded=c,e.peerConnection.createOffer({offerToReceiveAudio:0,offerToReceiveVideo:0,voiceActivityDetection:!1}).then(t=>{t.sdp=i(t.sdp,/m=video(:?.*)?/,\"H264\"),e.config.media.video.bitrate&&(t.sdp=n(t.sdp,\"video\",e.config.media.video.bitrate)),t.sdp=t.sdp.replace(\"a=fmtp:111 minptime=10;useinbandfec=1\",\"a=fmtp:111 useinbandfec=1;minptime=10;stereo=1;cbr=1;maxaveragebitrate=128000\"),w.d(`local offer: ${JSON.stringify(t)}`),e.peerConnection.setLocalDescription(t).then(()=>{w.d(\"local description setted\");const n=e.signaler.createMessage({command:\"sdp\",body:JSON.stringify(t)});n.to=e.channel.members[0].id,e.signaler.send(n)})}),e.health.start())},onWatch(t){w.i(`start onWatch with chid: ${t.channel.id}`),e.channel=t.channel,e.callEvent({name:\"onWatch\",param:{channel:e.channel}}),e.role=\"VIEWER\",e.peerConnection=new RTCPeerConnection(e.config.rtc,e.config.rtc.opt),e.peerConnection.onicecandidate=o,e.peerConnection.ontrack=d,e.peerConnection.oniceconnectionstatechange=a,e.peerConnection.to=e.channel.members[0].id,e.peerConnection.onnegotiationneeded=c},onSearch(t){if(w.d(`onSearch ${JSON.stringify(t.body)}`),t.body){var n=new Set;t.body.forEach(e=>{n.add(e.id)}),t.body=[...n],e.callEvent({name:\"onSearch\",param:t.body})}},pong(e){},async onSdp(t){w.d(`onSdp: ${t.body}`);const n=new RTCSessionDescription(JSON.parse(t.body));e.peerConnection.to=t.from,\"DC\"!==t.pctype?(e.peerConnection.setRemoteDescription(n).then(()=>{w.i(\"remote description is set\")}).catch(e=>{throw new C({code:\"1300\",text:\"remote description is wrong\"})}),\"offer\"===n.type&&e.peerConnection.createAnswer().then(t=>{t.sdp=t.sdp.replace(\"a=fmtp:111 \",\"a=fmtp:111 useinbandfec=1;minptime=10;stereo=1;cbr=1;maxaveragebitrate=128000\"),e.peerConnection.setLocalDescription(t).then(()=>{w.d(\"local description is set\");const n=e.signaler.createMessage({command:\"sdp\",body:JSON.stringify(t)});n.to=e.peerConnection.to,e.signaler.send(n)})}).catch(e=>{throw new C({code:\"1300\",text:\"failed to create answer\"},e)})):\"offer\"===n.type?e.messaging.startAnswer(n):e.messaging.setRemoteDesciption(n)},async onIce(t){const n=new RTCIceCandidate(JSON.parse(t.body));w.d(\"candidate: \",JSON.stringify(n)),t.pctype&&\"DC\"===t.pctype?e.dataConnection.addIceCandidate(n):e.peerConnection.addIceCandidate(n)}};function n(e,t,n){for(var i=e.split(\"\\n\"),o=-1,r=0;r<i.length;r++)if(0===i[r].indexOf(\"m=\"+t)){o=r;break}if(-1===o)return console.debug(\"Could not find the m line for\",t),e;for(console.debug(\"Found the m line for\",t,\"at line\",o),o++;0===i[o].indexOf(\"i=\")||0===i[o].indexOf(\"c=\");)o++;if(0===i[o].indexOf(\"b\"))return console.debug(\"Replaced b line at line\",o),i[o]=\"b=AS:\"+n,i.join(\"\\n\");console.debug(\"Adding new b line before line\",o);var a=i.slice(0,o);return a.push(\"b=AS:\"+n),(a=a.concat(i.slice(o,i.length))).join(\"\\n\")}function i(e,t,n){var i,o,r,a=[],s=new RegExp(\"a=rtpmap:(\\\\d+) \"+n+\"/\\\\d+\");if(!(i=e.match(t)))return e;if(!(o=e.match(s)))return e;i=i[0],o=o[1],r=i.split(\" \"),a.push(r[0]),a.push(r[1]),a.push(r[2]),a.push(o);for(var c=3;c<r.length;c++)r[c]!==o&&a.push(r[c]);return e.replace(i,a.join(\" \"))}function o(t){console.log(\"ice candidate is created\"),console.log(t.candidate);const n=e.signaler.createMessage({command:\"ice\",body:JSON.stringify(t.candidate)});n.to=e.peerConnection.to,e.signaler.send(n)}function r(t){console.log(\"ice candidate for dc is created\"),console.log(t.candidate);const n=e.signaler.createMessage({command:\"ice\",body:JSON.stringify(t.candidate)});n.to=e.peerConnection.to,n.pctype=\"DC\",e.signaler.send(n)}function a(t){if(e&&\"CLOSE\"!==e.state)if(w.i(`ice con evt: ${e.peerConnection.iceConnectionState}`),\"connected\"===e.peerConnection.iceConnectionState)e.remoteStream.getAudioTracks().length>1?(e.remoteMedia.srcObject=new MediaStream([e.remoteStream.getAudioTracks()[0]]),e.remoteMedia2&&(e.remoteMedia2.srcObject=new MediaStream([e.remoteStream.getAudioTracks()[1]]))):e.remoteMedia.srcObject=e.remoteStream,e.state=\"COMPLETE\",e.startTime=(new Date).getTime(),e.callEvent({name:\"onComplete\",param:{channel:e.channel}});else if(\"closed\"===e.peerConnection.iceConnectionState)\"CLOSE\"!==e.state&&(e.elive.close(),e.endTime=(new Date).getTime(),w.t(e,M.makeTransactionLog(e)));else{if(\"failed\"===e.peerConnection.iceConnectionState){if(\"CLOSE\"===e.state)return;throw e.state=\"FAIL\",e.endTime=(new Date).getTime(),w.t(e,M.makeTransactionLog(e)),new C({code:\"1300\",text:\"ice connecting is failed\"})}\"disconnected\"===e.peerConnection.iceConnectionState&&(\"CLOSE\"!==e.state&&(e.state=\"CLOSE\",e.endTime=(new Date).getTime(),w.t(e,M.makeTransactionLog(e))),e.callEvent({name:\"onClose\",param:{}}))}}function s(t){if(e&&\"CLOSE\"!==e.state)switch(w.i(`ice con evt: ${e.peerConnection.iceConnectionState}`),e.peerConnection.iceConnectionState){case\"connected\":\"P2P\"===e.channel.type&&(e.signaler.close(),e.isConnectToSig=!1,e.remoteMedia.srcObject=e.remoteStream),e.state=\"COMPLETE\",e.startTime=(new Date).getTime(),e.transceivers=e.peerConnection.getTransceivers(),e.callEvent({name:\"onComplete\",param:{channel:e.channel}});break;case\"closed\":\"CLOSE\"!==e.state&&(e.elive.close(),e.endTime=(new Date).getTime(),w.t(e,M.makeTransactionLog(e)));break;case\"failed\":throw e.state=\"FAIL\",e.endTime=(new Date).getTime(),w.t(e,M.makeTransactionLog(e)),new C({code:\"1300\",text:\"ice connecting is failed\"});case\"disconnected\":\"CLOSE\"!==e.state&&(e.endTime=(new Date).getTime(),w.t(e,M.makeTransactionLog(e)),e.elive.close())}}function c(e){w.w(\"negotiation is needed\")}function d(t){w.d(\"received track\"),console.dir(t),\"track\"===t.type&&(e.remoteStream.addTrack(t.track),e.transceivers=e.peerConnection.getTransceivers())}e.signaler.onMessage(function(e){const n=JSON.parse(e.data),i=n.command;w.d(`-> msg: ${n.command}`,n),t[i](n)})}(this.ctx),this.ws=new WebSocket(this.ctx.config.sdk.url.sig),this.ws.onopen=(()=>{w.i(\"Sig: success connect to sig server\"),this.ctx.isConnectToSig=!0,this.ctx.callEvent({name:\"init\",param:{}})}),this.ws.onerror=(e=>{throw new C({code:\"1400\",text:\"websocket is failed\"},e)}),this.ws.onclose=(e=>{w.i(\"websocket is closed\")}),this.ws.onmessage=this.onMessageHandler,w.d(\"finished signaler init\")}onMessage(e){this.onMessageHandler=e}async call(e){await this._sendCommand(\"call\",e,\"P2P\")}async cast(e){await this._sendCommand(\"cast\",e,\"BROADCAST\")}async watch(e){await this._sendCommand(\"watch\",e,\"BROADCAST\")}async search(e){await this.waitForConnection();const t=this.createMessage({command:\"search\"});this.send(t)}async _sendCommand(e,t,n){await this.waitForConnection(),w.i(\"start \"+e),this.ctx.channel.id=t,this.ctx.channel.type=n;const i=this.createMessage({command:e});w.v(i),this.send(i)}send(e){const t=JSON.stringify(e);if(this.ws)try{this.ws.send(t)}catch(e){throw new C({code:\"1400\",text:\"send error\"},e)}}close(){w.d(\"signaler is close\"),this.ws.close(),this.ctx.isConnectToSig=!1}createMessage({command:e,body:t}){return{command:e,token:this.ctx.token,serviceId:this.ctx.config.credential.serviceId,channel:this.ctx.channel,body:t}}async waitForConnection(){for(let e=5;e<=this.MAX_RETRIES;e++){if(!0===this.ctx.isConnectToSig)return;{const t=Math.pow(2,e);w.d(\"wating for init %i\",e),await this.wait(t)}}}wait(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}}async function T(e){w.d(\"start auth with context\");const t={credential:{key:e.config.credential.key,serviceId:e.config.credential.serviceId},env:{os:s.os.family,osVersion:s.os.version||\"0\",device:s.name,deviceVersion:s.version||\"0\",sdkVersion:e.version,purpose:e.purpose,country:e.config.sdk&&e.config.sdk.country?e.config.sdk.country:\"KR\",mode:e.config.sdk.mode}};e.config.sdk.coachId&&(t.env.coachId=e.config.sdk.coachId);const n={method:\"POST\",headers:{Accept:\"application/json, text/plain, */*\",\"Content-Type\":\"application/json\"},body:JSON.stringify(t)};try{const i=await fetch(e.config.sdk.url.auth,n),o=await i.json();Object.keys(o).forEach(t=>{switch(t){case\"iceServers\":o[t].forEach(t=>e.config.rtc.iceServers.push(t));break;case\"token\":e.token=o[t];break;case\"coach\":e.config.sdk.url.sig=o[t].url;break;case\"channelLogUrl\":e.config.sdk.url.channelLog=o[t]}})}catch(t){throw console.error(t),new C({code:1600,text:`Auth is failed with id:${e.config.credential.serviceId}/ key:${e.config.credential.key}`})}if(!e.token)throw new C({code:1600,text:`failed to auth with id: ${e.config.credential.serviceId} and key: ${e.config.credential.key}`});w.d(\"success auth\")}var E={credential:{serviceId:void 0,key:void 0},view:{local:void 0,remote:void 0,remote2:void 0},rtc:{iceServers:[{urls:\"stun:stun.l.google.com:19302\"}],opt:{},dataOpt:{optional:[{RtpDataChannels:!0}]},sdpSemantics:\"unified-plan\"},media:{video:{frameRate:{min:20,max:30}},audio:{channelCount:2}},sdk:{url:{auth:\"https://auth.remotemonster.com/auth\",log:\"https://signal.remotemonster.com:2001/topics\",channelLog:\"\"},logLevel:\"INFO\",audioType:\"voice\",mode:\"prod\",coachId:void 0,country:void 0}};class k{constructor(e){this.ctx=e}async captureScreen(){this.ctx.localStream=await navigator.mediaDevices.getDisplayMedia({video:!0}),this.ctx.transceivers[1].sender.replaceTrack(this.ctx.localStream.getTracks()[0]),this.ctx.localStream.addTrack(this.ctx.transceivers[0].sender.track),this.ctx.localVideo.srcObject=this.ctx.localStream}stopCaptureScreen(){showLocalVideo()}async validateDevices(){w.d(\"start gathering available devices\");var e=-1,t=-1;if(this.ctx.config.media.video&&this.ctx.config.media.video.deviceId&&(e=this.ctx.config.media.video.deviceId),this.ctx.config.media.audio&&this.ctx.config.media.audio.deviceId&&(t=this.ctx.config.media.audio.deviceId),await navigator.mediaDevices.enumerateDevices().then(n=>{for(var i=0;i<n.length;i++){const r=n[i];if(\"videoinput\"===r.kind){var o=this.ctx.devices.videoInput.push({text:r.label,id:r.deviceId});r.deviceId===e&&(this.ctx.devices.currentVideoInput=o-1)}else\"audioinput\"===r.kind?(o=this.ctx.devices.audioInput.push({text:r.label,id:r.deviceId}),r.deviceId===t&&(this.ctx.devices.currentAudioInput=o-1)):\"audiooutput\"===r.kind&&this.ctx.devices.audioOutput.push({text:r.label,id:r.deviceId})}}),0===this.ctx.devices.videoInput.length||0===this.ctx.devices.audioInput.length)throw new C({code:\"1500\",text:\"there is no input device\"});-1===this.ctx.devices.currentVideoInput&&this.ctx.devices.videoInput.length>0&&(this.ctx.devices.currentVideoInput=0),-1===this.ctx.devices.currentAudioInput&&this.ctx.devices.audioInput.length>0&&(this.ctx.devices.currentAudioInput=0),document.querySelector(\"#\"+this.ctx.config.view.local)&&(this.ctx.localVideo=document.querySelector(\"#\"+this.ctx.config.view.local)),document.querySelector(\"#\"+this.ctx.config.view.remote)&&(this.ctx.remoteMedia=document.querySelector(\"#\"+this.ctx.config.view.remote)),document.querySelector(\"#\"+this.ctx.config.view.remote2)&&(this.ctx.remoteMedia2=document.querySelector(\"#\"+this.ctx.config.view.remote2)),w.d(\"finish gathering available devices: ${JSON.stringify(this.ctx.devices)}\")}setVideoInput(e){w.d(\"start to set video input with \"+e);const t=this.findDevice(e,this.ctx.devices.videoInput);if(-1==t)throw new C({code:\"1500\",text:\"incorrect video device. input a right video device id.\"});this.ctx.devices.currentVideoInput=t,this.ctx.config.media.video.deviceId=this.ctx.devices.videoInput[t].id,w.d(\"finish to set video input with \"+e)}setAudioInput(e){w.d(\"start to set audio input with \"+e);const t=this.findDevice(e,this.ctx.devices.audioInput);if(-1==t)throw new C({code:\"1500\",text:\"incorrect audio device. input a right audio device id.\"});this.ctx.devices.currentAudioInput=t,this.ctx.config.media.audio.deviceId=this.ctx.devices.audioInput[t].id,w.d(\"finish to set audio input with \"+e)}async switchCamera(){w.d(\"start to switch camera\"),this.ctx.devices.videoInput.length<2||(++this.ctx.devices.currentVideoInput===this.ctx.devices.videoInput.length&&(this.ctx.devices.currentVideoInput=0),this.showLocalVideo(this.ctx.devices.videoInput[this.ctx.devices.currentVideoInput].id),this.ctx.config.media.video.deviceId={exact:[this.ctx.devices.videoInput[this.ctx.devices.currentVideoInput].id]},w.d(\"finish to switch camera\"))}muteRemote(e){this.ctx.transceivers&&(this.ctx.transceivers[1].receiver.track.enabled=!e,this.ctx.transceivers[0].receiver.track.enabled=!e)}muteLocal(e){this.ctx.transceivers&&(this.ctx.transceivers[1].sender.track.enabled=!e,this.ctx.transceivers[0].sender.track.enabled=!e)}async showLocalVideo(e){var t;if(w.d(`start to show localvideo with dev id ${e}`),e&&this.setVideoInput(e),!(t=await navigator.mediaDevices.getUserMedia(this.ctx.config.media)))throw new C({code:\"1500\",text:\"can not get user media\"});this.ctx.localVideo.srcObject=t,this.ctx.localStream=t,this.ctx.callEvent({name:\"onDisplayUserMedia\",param:t}),null!==this.ctx.transceivers&&this.ctx.transceivers.length>1&&this.ctx.transceivers[1].sender.replaceTrack(this.ctx.localStream.getVideoTracks()[0]),w.d(`finish to show localvideo with dev id ${e}`)}findDevice(e,t){w.d(`start find device ${e}`);for(var n=0;n<t.length;n++)if(t[n].id===e)return n;return w.d(`finish find device ${e}`),-1}setResolution(e,t){this.ctx.config.media.video.width=e,this.ctx.config.media.video.height=t,this.applyRuntime(\"video\")}setFrameRate(e){this.ctx.config.media.video.frameRate=e,this.applyRuntime(\"video\")}setAgc(e){this.ctx.config.media.audio.autoGainControl=e,this.applyRuntime(\"audio\")}setChannelCount(e){this.ctx.config.media.audio.channelCount=e,this.applyRuntime(\"audio\")}setEchoCancellation(e){this.ctx.config.media.audio.echoCancellation=e,this.applyRuntime(\"audio\")}setLatency(e){this.ctx.config.media.audio.latency=e,this.applyRuntime(\"audio\")}setNoiseSuppression(e){this.ctx.config.media.audio.noiseSuppression=e,this.applyRuntime(\"audio\")}setSampleRate(e){this.ctx.config.media.audio.sampleRate=e,this.applyRuntime(\"audio\")}setSampleSize(e){this.ctx.config.media.audio.sampleSize=e,this.applyRuntime(\"audio\")}setVolume(e){this.ctx.config.media.audio.volume=sampleRate,this.applyRuntime(\"audio\"),this.ctx.transceivers&&this.ctx.transceivers[0].receiver.track.applyConstraints({volume:e})}applyRuntime(e){this.ctx.transceivers&&(\"video\"===e?this.ctx.transceivers[1].sender.track.applyConstraints(this.ctx.config.media.video):\"audio\"===e&&this.ctx.transceivers[0].sender.track.applyConstraints(this.ctx.config.media.audio))}}class R{constructor(e){this.interval=5e3,this.statsReportTimer=null,this.context=e}stop(){this._clear()}start(){this._clear(),this.statsReportTimer=window.setInterval(()=>{this.context.signaler.send(this.context.signaler.createMessage({command:\"ping\",body:{}}))},this.interval)}_clear(){this.statsReportTimer&&(window.clearInterval(this.statsReportTimer),this.statsReportTimer=null)}}class L extends p{constructor(e){super();try{this.version=i}catch(e){}if(!e)throw new C({code:\"1200\",text:\"no config object\"});this.ctx=new S,this.ctx.version=this.version,this.ctx.elive=this,this.ctx.config=c(E,e),w.init(this.ctx),this.ctx.callEvent=this.onEvent,this.devManager=new k(this.ctx),this.ctx.signaler=new I(this.ctx),\"music\"===this.ctx.config.sdk.audioType&&(this.ctx.config.rtc.opt=M.getMusicConfiguration()),M.validateConfig(this.ctx),this.search=this.search.bind(this),this.ctx.health=new R(this.ctx)}async call(e){this.ctx.remoteStream||(this.ctx.remoteStream=new MediaStream),this.ctx.purpose=\"P2P\",0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),await T(this.ctx),await this.devManager.showLocalVideo(),await this.ctx.signaler.init(),this.ctx.signaler.call(e),w.d(`finish to call the ${e} room`)}async cast(e){this.ctx.localStream||(this.ctx.localStream=new MediaStream),this.ctx.purpose=\"CAST\",0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),await T(this.ctx),await this.devManager.showLocalVideo(),await this.ctx.signaler.init(),this.ctx.signaler.cast(e),w.d(`finish to cast the ${e} room`)}async watch(e){this.ctx.remoteStream||(this.ctx.remoteStream=new MediaStream),this.ctx.purpose=\"CAST\",this.ctx.remoteMedia=document.querySelector(\"#\"+this.ctx.config.view.remote),await T(this.ctx),await this.ctx.signaler.init(),this.ctx.signaler.watch(e),w.d(`finish to call the ${e} room`)}async close(){\"CLOSE\"===this.ctx.state&&null===this.ctx.peerConnection||(this.ctx.state=\"CLOSE\",this.ctx.endTime=(new Date).getTime(),w.t(this.ctx,M.makeTransactionLog(this.ctx)),this.ctx.isConnectToSig=!1,this.ctx.messaging&&this.ctx.messaging.close(),this.ctx.signaler.close(),this.ctx.peerConnection&&await this.ctx.peerConnection.getTransceivers().forEach(e=>e.direction=\"inactive\"),this.ctx.peerConnection&&(this.ctx.peerConnection.close(),this.ctx.peerConnection=null,this.ctx.remoteStream&&this.ctx.remoteStream.getTracks().forEach(e=>this.ctx.remoteStream.removeTrack(e)),this.ctx.transceivers=null,this.ctx.callEvent({name:\"onClose\",param:{channel:this.ctx.channel}}),this.ctx.health.stop()))}sendMessage(e){this.ctx.messaging.sendMessage(e)}onEvent(e){this.elive.emit(e.name,e.param)}setVideoQuality(e){}setFrameRate(e){this.devManager.setFrameRate(e)}setResolution(e,t){this.devManager.setResolution(e,t)}setAgc(e){this.devManager.setAgc(e)}setChannelCount(e){this.devManager.setChannelCount(e)}setEchoCancellation(e){this.devManager.setEchoCancellation(e)}setLatency(e){this.devManager.setLatency(e)}setNoiseSuppression(e){this.devManager.setNoiseSuppression(e)}setSampleSize(e){this.devManager.setSampleSize(e)}setSampleRate(e){this.devManager.setSampleRate(e)}setVolume(e){this.devManager.setVolume(e)}async captureScreen(){this.devManager.captureScreen()}stopCaptureScreen(){this.devManager.stopCaptureScreen()}async setVideoInput(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),this.devManager.setVideoInput(e)}async setAudioInput(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),this.devManager.setAudioInput(e)}async showLocalVideo(e){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),await this.devManager.showLocalVideo(e)}async switchCamera(){0==this.ctx.devices.audioInput.length&&await this.devManager.validateDevices(),this.devManager.switchCamera()}muteRemote(e){this.devManager.muteRemote(e)}muteLocal(e){this.devManager.muteLocal(e)}getDevices(){return this.ctx.devices}getHealth(){}getState(){}getRoomId(){return this.ctx.channel.id}async search(e){this.ctx.purpose=\"CAST\",this.ctx&&(this.ctx.signaler&&!this.ctx.isConnectToSig&&(await T(this.ctx),await this.ctx.signaler.init()),this.ctx&&this.ctx.signaler&&this.ctx.signaler.search(e))}status(){return{version:this.version,platform:s.name,platformVersion:s.version}}}try{L.version=i,L.env=\"prod\"}catch(i){L.version=\"3.0.0\",L.env={}}}]);","extractedComments":[]}